# scripts/ - データ変換スクリプト

NADESHIKOプロジェクトのデータ変換・処理スクリプトを格納するフォルダ。

---

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `csv_to_deals_all.py` | 利益管理CSV→TypeScript変換（4フォーマット対応） |
| `csv_to_views.py` | 再生数CSV→JSON+TypeScript変換（3タイプ対応、22ファイル→4,781件） |
| `xlsx_to_csv_views.py` | 再生数Excel→CSV変換（月別6シート） |
| `xlsx_to_csv_views_old.py` | 過去再生数Excel→CSV変換（月別16シート） |

---

## csv_to_deals_all.py

### 概要

利益管理シートCSVファイルをWebアプリ用のTypeScriptデータに変換するスクリプト。

### 対応フォーマット

| フォーマット | 期間 | ヘッダー例 |
|-------------|------|-----------|
| 旧フォーマット | 2023-11〜2025-08 | `Month, アカウント名, 案件名, 取引先...` |
| 9月フォーマット | 2025-09 | `アカウント名, 案件名, 取引先, 摘要, 単価...` |
| 10月フォーマット | 2025-10 | `請求書, 区分, アカウント名, 請求項目...` |
| 新フォーマット | 2025-11〜 | `担当者, クライアント, 案件名, アカウント名...` |

### 実行方法

```bash
python3 scripts/csv_to_deals_all.py
```

### 入出力

| 項目 | パス |
|------|------|
| 入力 | `data/利益管理シート/*.csv` |
| 出力 | `webapp/src/data/deals-data.ts` |

### 処理結果（最新）

| 項目 | 値 |
|------|-----|
| 総案件数 | 1,102件 |
| 対象月数 | 30月（2023年11月〜2026年4月） |

---

## csv_to_views.py

### 概要

再生数シートCSVファイルをWebアプリ用のJSON + TypeScriptラッパーに変換するスクリプト。

### 対応フォーマット（3タイプ）

| タイプ | 期間 | 日付形式 | sns/担当者 |
|-------|------|----------|-----------|
| タイプA | 2024年4月〜9月 | 相対日付（04/12(金)） | 空 |
| タイプB | 2024年10月〜2025年7月 | ISO日付 | 空 |
| タイプC | 2025年8月〜2026年1月 | ISO日付 | あり |

### 実行方法

```bash
python3 scripts/csv_to_views.py
```

### 入出力

| 項目 | パス |
|------|------|
| 入力 | `data/再生数シート/*.csv`（22ファイル） |
| 出力 | `webapp/src/data/views-data.json`、`webapp/src/data/views-data.ts` |

### 処理結果

| 項目 | 値 |
|------|-----|
| 入力CSVファイル | 22件 |
| 入力行数 | 6,304行 |
| 出力レコード | 4,781件（views=0除外後） |
| プラットフォーム | TikTok: 4,755件、IG: 26件 |

---

## xlsx_to_csv_views.py

### 概要

再生数シートExcelファイルを月別CSVに変換するスクリプト。

### 実行方法

```bash
python3 scripts/xlsx_to_csv_views.py
```

### 入出力

| 項目 | パス |
|------|------|
| 入力 | `data/再生数シート/NADESHIKO 分析.xlsx` |
| 出力 | `data/再生数シート/2025年8月.csv` 〜 `2026年1月.csv` |

### 処理結果

| 月 | 行数 |
|---|------|
| 2026年1月 | 1,668 |
| 2025年12月 | 664 |
| 2025年11月 | 533 |
| 2025年10月 | 582 |
| 2025年9月 | 342 |
| 2025年8月 | 321 |
| **合計** | **4,110** |

---

## xlsx_to_csv_views_old.py

### 概要

過去再生数シートExcelファイル（投稿インサイトDB）を月別CSVに変換するスクリプト。

### 実行方法

```bash
python3 scripts/xlsx_to_csv_views_old.py
```

### 入出力

| 項目 | パス |
|------|------|
| 入力 | `data/過去再生数シート/【新】NADESIKO_投稿インサイトDB .xlsx` |
| 出力 | `data/再生数シート/2024年4月.csv` 〜 `2025年7月.csv` |

### 処理結果

| 月 | 行数 |
|---|------|
| 2024年4月 | 112 |
| 2024年5月 | 104 |
| 2024年6月 | 96 |
| 2024年7月 | 103 |
| 2024年8月 | 84 |
| 2024年9月 | 112 |
| 2024年10月 | 152 |
| 2024年11月 | 167 |
| 2024年12月 | 152 |
| 2025年1月 | 134 |
| 2025年2月 | 154 |
| 2025年3月 | 138 |
| 2025年4月 | 180 |
| 2025年5月 | 163 |
| 2025年6月 | 173 |
| 2025年7月 | 170 |
| **合計** | **2,194** |

---

## 更新履歴

- 2026-01-23: csv_to_views.py追加（再生数CSV→JSON変換、3タイプ対応）
- 2026-01-23: xlsx_to_csv_views_old.py拡張（2024年4月〜12月追加、計16ファイル）
- 2026-01-23: xlsx_to_csv_views_old.py追加（過去再生数シート変換）
- 2026-01-23: xlsx_to_csv_views.py追加（再生数シート変換）
- 2026-01-23: 初版作成（4フォーマット対応、1,102件変換）
